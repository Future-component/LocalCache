<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <title>本地缓存demo</title>
</head>
<body>
  <script src="../index.js?v=21"></script>
  <script>
    var cache = new localCache({ debug: true });
    console.log(cache)

    var typeCache = cache.createCache();
    typeCache('monitor');
    console.log(typeCache('monitor'));

    typeCache('monitor', 'beth');
    console.log(typeCache('monitor'));

    console.time('no-key')
    var monitor = 'beth';
    console.log(monitor);
    console.timeEnd('no-key');

    // 验证
    var count = 0;
    function createFib() {
      function fib(n) {
        console.log(count, n)
        if (n <= 2) {
          count++;
          return 1;
        } else {
          count = fib(n - 1) + fib(n - 2);
        }
        return count;
      }
      return fib;
    }

    // var fib = createFib();
    // console.time('no-cache-fib');
    // fib(10);
    // console.log(count);
    // console.timeEnd('no-cache-fib');
    // count = 0;
    // console.time('no-cache-fib');
    // fib(20);
    // console.log(count);
    // console.timeEnd('no-cache-fib');

    var count1 = 0;
    function createCacheFib() {
      var fibCache = cache.createCache();
      function fib(n) {
        count1++;
        // 从cache中缓存数据
        if (fibCache(n) !== undefined) {
          // 如果缓存中有直接返回
          return fibCache(n);
        }
        // 如果缓存中没有 就计算
        if (n <= 2) {
          // 把计算结果存入数组
          fibCache(n, 1);
          return 1;
        }
        var temp = fib(n - 1) + fib(n - 2);
        // 把计算结果存入数组
        fibCache(n, temp);
        return temp;
      }

      return fib;
    }

    // var fib1 = createCacheFib();
    // console.time('cache-fib');
    // fib1(10);
    // console.log(count1);
    // console.timeEnd('cache-fib');
    // count1 = 0;
    // console.time('cache-fib');
    // fib1(20);
    // console.log(count1);
    // console.timeEnd('cache-fib'); 

    console.time('cookie')
    var cookies = cache.cookie.getAll();
    console.log(cookies)
    cache.cookie.set('xq', JSON.stringify({ name: 'beth' }), 1);
    var xq = cache.cookie.get('xq');
    console.log(xq && JSON.parse(xq))
    cache.cookie.remove('xq');
    cache.cookie.set('xq', JSON.stringify({ name: 'beth' }), 1);
    cache.cookie.clear();
    console.timeEnd('cookie')

    var cacheStorage = cache.storage();
    console.time('storage')
    cacheStorage.set('xq', JSON.stringify({ name: 'beth' }))
    var storages = cacheStorage.getAll();
    console.log(storages)
    var xq = cacheStorage.get('xq');
    console.log(xq && JSON.parse(xq))
    cacheStorage.remove('xq');
    cacheStorage.set('xq', JSON.stringify({ name: 'beth' }))
    cacheStorage.clear();
    console.timeEnd('storage')
  </script>
</body>
</html>